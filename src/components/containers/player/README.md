# 思路

## 初始化控制点

控制点就是四个角的伸缩操作点和初始状态下下面的旋转点

### 获取步骤

1. 控制点的位置是相对于画布的
2. 先获取目标元素中点的坐标（通过 `getBoundingClientRect()` 获取相对于画布左上角和位置和宽高，然后用左上角 `x, y` 分别加上 `width / 2` 和 `height /2` 即为中心点坐标）
3. 如何获取四个角坐标呢？显然不能直接获取，因为目标元素可能被旋转或缩放过，此时就要获取目标元素的 `translate(x, y)` 中的 `x, y`，这个属性是目标元素初始时的位置
4. 通过 `centerX, centerY` 减去 `translate(x, y)` 中的 `x, y` 再 `*2` 就可以获取初始状态下宽高的宽度

## 旋转

1. 点击控制目标元素时，获取目标中心中心点相对于画布的位置，这个位置就是旋转的中心点，拖动旋转时，根据当前拖动的点和这个中心点计算出旋转角度
2. 通过 `getRotatedPoint` 可以计算获取旋转后控制点的位置，旋转时调用该方法更新控制点位置即可
3. 把这个旋转角度更新到 `rotate(?deg)`

## 缩放

1. 缩放是根据当前点到直线（穿过中点并且旋转角度和当前元素旋转角度一致的直线）距离进行计算的
2. 在初始化控制点步骤中已经得到初始状态下的宽高，只要用拖拽点距离直线的距离和初始状态下的距离相除即可获取需要缩放的比例
3. 把这个缩放比例更新到 `scale(?)`

## 移动

1. 首先记录开始拖拽时点的位置
2. 拖拽过程中计算当前点和开始拖拽点的差值，然后开始位置加上差值即可得到新的位置
3. 把这个位置更新到 `translate(x, y)`

## 随画布缩放而缩放

1. 开始缩放时，记录画布当前的宽度，并且记录下初始状态下元素的宽高和位置
2. 缩放过程中会不断改变画布宽度，用当前宽度除初始宽度即可得到缩放比例
3. 用元素初始状态下的宽高位置乘以缩放比例即可得到新的位置和宽高
4. 在缩放过程中，还需要实时更新 `movableControl` 控制点的位置，确保和元素保持一致
